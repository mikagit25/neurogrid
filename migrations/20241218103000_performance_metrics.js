/**\n * Migration: Performance Metrics Tracking\n * Created: 2024-12-18T10:30:00.000Z\n */\n\nmodule.exports = {\n    async up(client) {\n        // Create system metrics table\n        await client.query(`\n            CREATE TABLE IF NOT EXISTS system_metrics (\n                id SERIAL PRIMARY KEY,\n                metric_name VARCHAR(100) NOT NULL,\n                metric_value DECIMAL(15, 6) NOT NULL,\n                metric_type VARCHAR(50) NOT NULL, -- counter, gauge, histogram\n                labels JSONB DEFAULT '{}',\n                \n                recorded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n                \n                INDEX idx_metric_name (metric_name),\n                INDEX idx_metric_type (metric_type),\n                INDEX idx_recorded_at (recorded_at)\n            )\n        `);\n        \n        // Create API performance metrics\n        await client.query(`\n            CREATE TABLE IF NOT EXISTS api_metrics (\n                id SERIAL PRIMARY KEY,\n                endpoint VARCHAR(255) NOT NULL,\n                method VARCHAR(10) NOT NULL,\n                status_code INTEGER NOT NULL,\n                response_time INTEGER NOT NULL, -- milliseconds\n                user_id INTEGER,\n                ip_address INET,\n                \n                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n                \n                INDEX idx_endpoint (endpoint),\n                INDEX idx_method (method),\n                INDEX idx_status_code (status_code),\n                INDEX idx_response_time (response_time),\n                INDEX idx_created_at (created_at)\n            )\n        `);\n        \n        // Create cache metrics table\n        await client.query(`\n            CREATE TABLE IF NOT EXISTS cache_metrics (\n                id SERIAL PRIMARY KEY,\n                cache_key VARCHAR(255) NOT NULL,\n                operation VARCHAR(20) NOT NULL, -- get, set, delete, hit, miss\n                tier VARCHAR(20),\n                ttl INTEGER,\n                size_bytes INTEGER,\n                \n                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n                \n                INDEX idx_cache_key (cache_key),\n                INDEX idx_operation (operation),\n                INDEX idx_tier (tier),\n                INDEX idx_created_at (created_at)\n            )\n        `);\n        \n        console.log('✅ Performance metrics tables created');\n    },\n\n    async down(client) {\n        // Rollback metrics tables\n        await client.query('DROP TABLE IF EXISTS cache_metrics');\n        await client.query('DROP TABLE IF EXISTS api_metrics');\n        await client.query('DROP TABLE IF EXISTS system_metrics');\n        \n        console.log('✅ Performance metrics tables dropped');\n    }\n};